# üêõ BUG FIXES - GUI System Issues

## –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### 1. UnsupportedOperationException –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ª–æ–¥–∫–∏ ‚ùå
**–û—à–∏–±–∫–∞:**
```
UnsupportedOperationException: Not supported - you must spawn a new entity to change boat type.
at org.bukkit.craftbukkit.entity.CraftBoat.setBoatType(CraftBoat.java:37)
```

**–ü—Ä–∏—á–∏–Ω–∞:**
–í Paper 1.21.10 –Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø –ª–æ–¥–∫–∏ –ø–æ—Å–ª–µ —Å–ø–∞–≤–Ω–∞ —Å –ø–æ–º–æ—â—å—é `setBoatType()`

**–†–µ—à–µ–Ω–∏–µ:**
–£–±—Ä–∞–ª–∏ —Å—Ç—Ä–æ–∫—É `boat.setBoatType(Boat.Type.OAK);` –∏–∑ BoatSpawner.java
EntityType.OAK_BOAT —É–∂–µ —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø –ª–æ–¥–∫–∏.

---

### 2. –õ–æ–¥–∫–∞ —Å–ø–∞–≤–Ω–∏—Ç—Å—è –ø–æ–¥ –≤–æ–¥–æ–π ‚ùå
**–ü—Ä–æ–±–ª–µ–º–∞:**
–õ–æ–¥–∫–∞ –ø–æ—è–≤–ª—è–ª–∞—Å—å –Ω–∞ Y-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–µ –≤–æ–¥—ã, –ø–æ—ç—Ç–æ–º—É –±—ã–ª–∞ –ø–æ–¥ –≤–æ–¥–æ–π. –°–µ—Å—Ç—å –≤ –Ω–µ—ë –Ω–µ–ª—å–∑—è.

**–ü—Ä–∏—á–∏–Ω–∞:**
```java
Location spawnLoc = availableDock.getLocation().clone().add(0.5, 0, 0.5);
//                                                                ^ 0 - –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤–æ–¥—ã!
```

**–†–µ—à–µ–Ω–∏–µ:**
–ò–∑–º–µ–Ω–∏–ª–∏ Y-offset —Å 0 –Ω–∞ 1.0:
```java
Location spawnLoc = availableDock.getLocation().clone().add(0.5, 1.0, 0.5);
//                                                                ^ 1.0 - –Ω–∞–¥ –≤–æ–¥–æ–π!
```

---

### 3. –õ–æ–¥–∫–∞ –ª–æ–º–∞–µ—Ç—Å—è (–Ω–µ invulnerable) ‚ùå
**–ü—Ä–æ–±–ª–µ–º–∞:**
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ `setInvulnerable(true)`, –ª–æ–¥–∫—É –º–æ–∂–Ω–æ —Å–ª–æ–º–∞—Ç—å —É–¥–∞—Ä–æ–º.

**–ü—Ä–∏—á–∏–Ω–∞:**
–í Paper API `setInvulnerable()` –¥–ª—è –ª–æ–¥–æ–∫ –Ω–µ –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏–ª–∏ VehicleListener.java —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç damage/destroy:
```java
@EventHandler
public void onVehicleDamage(VehicleDamageEvent event) {
    if (event.getVehicle() instanceof Boat boat) {
        if (plugin.getBoatManager().getBoatSpawner().isPortBoat(boat)) {
            event.setCancelled(true); // –û—Ç–º–µ–Ω—è–µ–º —É—Ä–æ–Ω
        }
    }
}
```

---

### 4. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞: 1 –ª–æ–¥–∫–∞ –Ω–∞ –∏–≥—Ä–æ–∫–∞ ‚ùå
**–ü—Ä–æ–±–ª–µ–º–∞:**
–ò–≥—Ä–æ–∫ –º–æ–≥ —Å–æ–∑–¥–∞—Ç—å —Ç–æ–ª—å–∫–æ 1 –ª–æ–¥–∫—É –≤–æ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º–µ –ø–æ—Ä—Ç–æ–≤. –ù–æ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å: —Å—Ç–æ–ª—å–∫–æ –ª–æ–¥–æ–∫, —Å–∫–æ–ª—å–∫–æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –ø—Ä–∏—á–∞–ª–æ–≤.

**–°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞:**
- 1 –∏–≥—Ä–æ–∫ = 1 –ª–æ–¥–∫–∞ –º–∞–∫—Å–∏–º—É–º
- –ü–æ—Ä—Ç —Å 3 –ø—Ä–∏—á–∞–ª–∞–º–∏ ‚Üí —Ç–æ–ª—å–∫–æ 3 –∏–≥—Ä–æ–∫–∞ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞—Ç—å –ª–æ–¥–∫–∏

**–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:**
- 1 –ø—Ä–∏—á–∞–ª = 1 –ª–æ–¥–∫–∞
- –ü–æ—Ä—Ç —Å 3 –ø—Ä–∏—á–∞–ª–∞–º–∏ ‚Üí –ª—é–±—ã–µ –∏–≥—Ä–æ–∫–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞—Ç—å 3 –ª–æ–¥–∫–∏
- –ü–æ—Ä—Ç —Å 4 –ø—Ä–∏—á–∞–ª–∞–º–∏ ‚Üí –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å 4 –ª–æ–¥–∫–∏

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. BoatManager.java - —É–±—Ä–∞–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É `hasBoat()` –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º
2. GUIListener.java - —É–±—Ä–∞–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ "You already have a boat"
3. PortGUI.java - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –ø—Ä–∏—á–∞–ª–æ–≤ –≤–º–µ—Å—Ç–æ "My Boat"

---

## üìÅ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. **BoatSpawner.java** ‚üµ —É–±—Ä–∞–ª setBoatType(), Y+1.0, –¥–æ–±–∞–≤–∏–ª isPortBoat()
2. **VehicleListener.java** ‚üµ –ù–û–í–´–ô - –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–ª–æ–º–∫–∏
3. **BoatManager.java** ‚üµ —É–±—Ä–∞–ª –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 1 –ª–æ–¥–∫–∞
4. **GUIListener.java** ‚üµ —É–±—Ä–∞–ª –ø—Ä–æ–≤–µ—Ä–∫—É hasBoat
5. **PortGUI.java** ‚üµ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–∏—á–∞–ª—ã
6. **GUIUtils.java** (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
7. **PlayerListener.java** (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
8. **NPCListener.java** (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
9. **GUIManager.java** (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
10. **BoatRoutesPlugin.java** (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

---

## ‚úÖ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:

‚úÖ –õ–æ–¥–∫–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –ë–ï–ó –æ—à–∏–±–æ–∫
‚úÖ –õ–æ–¥–∫–∞ —Å–ø–∞–≤–Ω–∏—Ç—Å—è –ù–ê–î –≤–æ–¥–æ–π (–º–æ–∂–Ω–æ —Å–µ—Å—Ç—å)
‚úÖ –õ–æ–¥–∫–∞ –ù–ï –ª–æ–º–∞–µ—Ç—Å—è (–ø–æ–ª–Ω–∞—è –∑–∞—â–∏—Ç–∞)
‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å—Ç–æ–ª—å–∫–æ –ª–æ–¥–æ–∫, —Å–∫–æ–ª—å–∫–æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –ø—Ä–∏—á–∞–ª–æ–≤
‚úÖ GUI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–µ—Å—Ç

---

## üéÆ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

```
1. /port create spawn
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å NPC –∏ 3 –ø—Ä–∏—á–∞–ª–∞
3. –ü–ö–ú –ø–æ NPC ‚Üí GUI
4. –°–æ–∑–¥–∞—Ç—å –ª–æ–¥–∫—É "Boat1" ‚Üí –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –ù–ê–î –≤–æ–¥–æ–π
5. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–ª–æ–º–∞—Ç—å ‚Üí –ù–ï –ª–æ–º–∞–µ—Ç—Å—è
6. –°–æ–∑–¥–∞—Ç—å –µ—â—ë –ª–æ–¥–∫—É "Boat2" ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è
7. –°–æ–∑–¥–∞—Ç—å –µ—â—ë –ª–æ–¥–∫—É "Boat3" ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è
8. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–æ–∑–¥–∞—Ç—å 4-—é ‚Üí "No docks available"
```

---

## üìã –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ LESSONS_LEARNED.md:

```markdown
## [2026-01-04] –û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–ø–∞–≤–Ω–µ –ª–æ–¥–æ–∫ –∏ –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:**
1. UnsupportedOperationException –ø—Ä–∏ setBoatType()
2. –õ–æ–¥–∫–∞ —Å–ø–∞–≤–Ω–∏—Ç—Å—è –ø–æ–¥ –≤–æ–¥–æ–π
3. –õ–æ–¥–∫–∞ –ª–æ–º–∞–µ—Ç—Å—è –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ setInvulnerable(true)
4. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 1 –ª–æ–¥–∫–∞ –Ω–∞ –∏–≥—Ä–æ–∫–∞ –≤–º–µ—Å—Ç–æ "1 –ª–æ–¥–∫–∞ –Ω–∞ –ø—Ä–∏—á–∞–ª"

**–ü—Ä–∏—á–∏–Ω–∞:**
1. Paper 1.21.10 –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∏–ø–∞ –ª–æ–¥–∫–∏ –ø–æ—Å–ª–µ —Å–ø–∞–≤–Ω–∞
2. Y-offset = 0 –æ–∑–Ω–∞—á–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –≤–æ–¥—ã, –ª–æ–¥–∫–∞ —Ç–æ–Ω–µ—Ç
3. setInvulnerable() –¥–ª—è –ª–æ–¥–æ–∫ –Ω–µ –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
4. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±—Ä–∞–ª–∏ boat.setBoatType() - EntityType.OAK_BOAT —É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø
2. –ò–∑–º–µ–Ω–∏–ª–∏ Y-offset —Å 0 –Ω–∞ 1.0 - –ª–æ–¥–∫–∞ —Å–ø–∞–≤–Ω–∏—Ç—Å—è –Ω–∞–¥ –≤–æ–¥–æ–π
3. –î–æ–±–∞–≤–∏–ª–∏ VehicleListener —Å VehicleDamageEvent/VehicleDestroyEvent
4. –ò–∑–º–µ–Ω–∏–ª–∏ –ª–æ–≥–∏–∫—É: —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å—Ç–æ–ª—å–∫–æ –ª–æ–¥–æ–∫, —Å–∫–æ–ª—å–∫–æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –ø—Ä–∏—á–∞–ª–æ–≤

**–£—Ä–æ–∫:**
‚úÖ Paper API –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏ - –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
‚úÖ –õ–æ–¥–∫–∏ –¥–æ–ª–∂–Ω—ã —Å–ø–∞–≤–Ω–∏—Ç—å—Å—è –Ω–∞–¥ –≤–æ–¥–æ–π (Y+1), –∏–Ω–∞—á–µ –æ–Ω–∏ —Ç–æ–Ω—É—Ç
‚úÖ setInvulnerable() –Ω–µ–Ω–∞–¥—ë–∂–µ–Ω –¥–ª—è vehicles, –∏—Å–ø–æ–ª—å–∑—É–π event listeners
‚úÖ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º: "1 –ª–æ–¥–∫–∞ –Ω–∞ –ø—Ä–∏—á–∞–ª", –∞ –Ω–µ "1 –Ω–∞ –∏–≥—Ä–æ–∫–∞"
```

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 4 —è–Ω–≤–∞—Ä—è 2026
**–°—Ç–∞—Ç—É—Å:** –í—Å–µ –±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã ‚úÖ
**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:** –î–ê
